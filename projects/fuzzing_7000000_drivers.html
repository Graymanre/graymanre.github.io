<!DOCTYPE html>
<html lang="en">

<head>
    <meta property="og:title" content="GraymanRe - Fuzzing 7000000 drivers" />
    <meta property="og:description" content="Fuzzing 7000000 drivers" />
    <meta property="og:image" content="https://graymanre.github.io/img/openvpn.webp" />
    <meta property="og:url" content="https://graymanre.github.io/" />
    <meta name="description" content="Blog post diving into the project of fuzzing allegedly 7000000 drivers"/>
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image" content="https://graymanre.github.io/img/openvpn.webp" />
    <meta name="twitter:creator" content="@grayman_re" />

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>GraymanRe - Deploying OpenVPN on pfSense using LDAP</title>

    <link rel="canonical" href="https://graymanre.github.io/">
    <link rel="alternate" type="application/rss+xml" title="GraymanRe" href="/feed.xml">
    <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">

    <!-- Ionicons -->
    <link href="https://unpkg.com/ionicons@4.2.2/dist/css/ionicons.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/prism.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#header-content').load('https://graymanre.github.io/header.html', function () {
                $.getScript('/js/common.js');
            });
            $("#footer-content").load("https://graymanre.github.io/footer.html");
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-4VZEKGVZPK"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-4VZEKGVZPK');
    </script>
</head>

<body class="is-in">
    <!-- begin header -->
    <header class="header">
        <div id="header-content"></div>
    </header>
    <!-- end header -->
    <!-- begin search -->
    <div class="search">
        <div class="container">
            <div class="row">
                <div class="col col-12">
                    <div class="search__box">
                        <div class="search__group">
                            <div class="search__close">
                                <i class="ion ion-md-close"></i>
                            </div>
                            <label for="js-search-input" class="screen-reader-text">Search for Post</label>
                            <input type="text" id="js-search-input" class="search__text" autocomplete="off" placeholder="Type to search...">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row search-results-list" id="js-results-container"></div>
        </div>
    </div>
    <!-- end search -->
    <!-- Start of custom content -->
    <main class="content" aria-label="Content">
        <div class="post-head">
            <div class="container">
                <div class="row">
                    <div class="col col-2"></div>
                    <div class="col col-8 col-t-12">
                        <div class="post-head__box">
                            <div class="post__meta">
                                <span id="time"></span> min read <time class="post__date" datetime="2024-12-29T00:00:00+02:00">- 29 August 2025</time>
                            </div>
                            <h2 class="post__title">Fuzzing 7000000 drivers</h2>
                            <div class="post__bottom">
                                <div class="post__author">
                                    <a href="/contact/" aria-label="GraymanRe">
                                        <img class="post__author-image"
                                             src="/img/banner.webp" alt="GraymanRe's Picture">
                                    </a>
                                </div>
                                <div class="post__bottom-meta">
                                    <a href="/contact/" class="post__author-link">GraymanRe</a>
                                    <span>in</span>
                                    <span class="post-tags">
                                        <a href="/projects" class="post__tag">Projects</a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- begin post -->
        <div class="container">
            <article id="article" class="post animate">
                <div class="post__content">
                    <h3 id="post__content__title">Introduction</h3>
                    <p>
                        An X account famous in the reverse engineering/malware scene named VX-Underground recently posted multiple messages on X revolving
                        around a 7000000 driver fuzzing project. Using IOCTLance and a previously on X discussed library of over 7000000 drivers, smelly
                        and team set out to fuzz all these drivers. It quickly appeared that the 7000000 was actually a previously bogus claim, because
                        after removing all kinds of irrelevant files from the library, only a couple of thousand actual drivers remained. 
                        <br><br>
                        Nonetheless, one should not understate the massive task this is to enable a fuzzing infrastructure to achieve optimized fuzzing
                        which would allow to obtain adequate results without having to wait for eterneties for all drivers to be fuzzed.
                        Today, in this blog, we set out to demonstrate how to achieve the task of fuzzing these thousands of drivers using IOCTLance in
                        a way that would enable scaling as well as some form of speed throughout the process. 
                        <br><br>
                        The main challenge we want to overcome is having a clean-state infrastructure setup for each driver in each specific fuzzing cycle,
                        so that no other software, system state or setting can affect the results. This would increase repeatability and ensure that regardless
                        of the environment, someone running the same fuzz test would receive the exact same results. 
                        <br>
                        To achieve this goal, we will be using fully open source projects and software in this demo and mainly depend on Proxmox, Minio,
                        cloud-init configurations, docker and of course IOCTLance.
                    </p>

                    <h3 id="post__content__title">Building the infrastructure</h3>
                    <p>
                        Lets start out by talking about the infrastructure that we will need to achieve the task of fuzzing these thousands of drivers.
                        We are going to rely on proxmox as a virtualization platform, but really any sort of virtual environment host would work. Within
                        proxmox we are going to build a golden fuzzing VM. Basically, the objective is to create a very simple, straightforward, clean and
                        small virtual machine which we can easily clone and perform testing on. This 
                    </p>

                    <h3 id="post__content__title">Hosting the drivers and storing the fuzzing results</h3>
                    <p>
                        Ideally, the drivers that will be subjected to fuzzing should not be hosted on our own system, but rather in a storage solution
                        which allows for quick and repetitive querying that can sustain both speed and scalability. One of the solutions that ended up in
                        our path was MinIO. This is a open source S3 compatiable object storage solution which would fit our requirements.
                        <br><br>
                        WinIO has a very straightforward deployment method using a docker container. We made sure that the docker container could query a
                        NAS or other large storage device (e.g. external hard drive) which would allow for storing the drivers. We also opted to ensure
                        that all fuzzing results were written back to the MinIO bucket to attain a high-speed transfer of results. Additionally, we want
                        to prevent repeated fuzzing of the same driver. So we also use the MinIO bucket as a method to store the state of a driver (either
                        unfuzzed or "done"). We will go into detail about this later. 
                        <br><br>
                        Do note, that it is important to ensure high-speed data transfers in your local network is possible. The higher the speeds you can
                        achieve the more quicker all actions around the MinIO storage container are bound to be completed. In my network, I have a dedicated 
                        internal network of 2.5Gbps for this specific purpose.
                    </p>

                    <h3 id="post__content__title">Achieving hands-off deployment</h3>
                    <p>
                        Ultimately, one of the objectives is that a complete cycle of cloning the golden VM, installing required tools, downloading the IOCTLance
                        fuzzing framework, fuzzing a given driver and ultimately storing the results 
                        
                        To control the proxmox instance from within our terraform file, we are going to add a new user (tfadmin) to our proxmox instance and give this user
                        an API key which terraform will be able to use. It is imperative, that when you set up this token, you add roles (and as such permissions)
                        to the tfadmin user account. For example, since we are using the cloud-init configuration file and store it in the local storage, the tfadmin
                        account needs both <span id="inline-code">Datastore.Audit</span> and <span id="inline-code">Datastore.AllocateSpace</span> permissions. 
                        It is most easiest, to enable these permissions using the <span id="inline-code">pveum</span> command within an SSH session to our proxmox host.
                        The required permission for the tfadmin user can be enabled using the command <span id="inline-code">pveum aclmod / -token "tfman@pam!tf_token" -role PVEAdmin -propagate 1</span>.
                        Do note, that for this example, I am giving the tfadmin user the <span id="inline-code">PVEAdmin</span> permissions. You might want to research
                        the specific permissions required and only apply the required permissions so as not to overprivilege your users.
                    </p>
                </div>
            </article>
        </div>
        <!-- end post -->
    </main>
    <!-- End of custom content -->

    <div class="top" title="Top"><i class="ion ion-ios-arrow-up"></i></div>
    <!-- begin footer-widgets -->
    <section class="footer-widgets">
        <div class="container">
            <div class="row">
                <div class="col col-4 col-d-6 col-t-12">
                    <div class="widget widget-tag-cloud">
                        <div class="widget__head">
                            <h3 class="widget__title">Explore Tags</h3>
                        </div>
                        <div class="tag__cloud">
                            <a href="/re/" class="set-1">Reverse Engineering</a>
                            <a href="/projects/" class="set-1">Projects</a>
                            <a href="/ctf/" class="set-1">CTF Writeups</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- end footer-widgets -->
    <!-- begin footer -->
    <footer class="footer">
        <div id="footer-content"></div>
    </footer>
    <!-- end footer -->
    <script src="/js/vendors/jquery-3.5.1.min.js"></script>
    <script src="/js/vendors/simple-jekyll-search.min.js"></script>
    <script src="/js/vendors/jquery.fitvids.js"></script>
    <script src="/js/vendors/lazyload.min.js"></script>
    <script src="/js/vendors/transition.js"></script>
    <script src="/js/vendors/zoom.min.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/readingtime.js"></script>
    <script>
        var base_url = "",
            pagination_next_url = base_url + '/page2',
            pagination_next_page_number = '',
            pagination_available_pages_number = '1';
    </script>
</body>

</html>